<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MythBuster: Inheritance Tax Edition</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }
        .chat-container {
            width: 90%;
            max-width: 400px;
            background: white;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            border-radius: 10px;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }
        .chat-box {
            max-height: 400px;
            overflow-y: auto;
            padding-bottom: 10px;
        }
        .message {
            padding: 10px;
            border-radius: 10px;
            margin-bottom: 10px;
            max-width: 80%;
            line-height: 1.5;
            cursor: pointer;
        }
        .user-message {
            background-color: #007bff;
            color: white;
            align-self: flex-end;
            text-align: right;
            cursor: default;
        }
        .bot-message {
            background-color: #e5e5ea;
            color: black;
            align-self: flex-start;
            text-align: left;
        }
        .selectable {
            background-color: #e5e5ea;
            border: 1px solid #d1d1d1;
            transition: background 0.3s;
        }
        .selectable:hover {
            background-color: #d1d1d1;
        }
        .typing-indicator {
            font-style: italic;
            color: gray;
            animation: blink 1.2s infinite;
        }
        @keyframes blink {
            0% { opacity: 0.2; }
            50% { opacity: 1; }
            100% { opacity: 0.2; }
        }
    </style>
</head>
<body>

    <div class="chat-container">
        <div class="chat-box" id="chat-box">
            <div class="bot-message message">ðŸ‘‹ Hi there! Iâ€™m <b>MythBuster</b>, your friendly inheritance tax fact-checker. Let's bust some myths together! ðŸ’¡</div>
            <div class="bot-message message">Iâ€™m here to help clear up any misconceptions you might have. Choose a myth below, and Iâ€™ll tell you the facts.</div>
            <div id="options"></div>
        </div>
    </div>

    <script>
        function showMyths() {
            let chatBox = document.getElementById("chat-box");
            let optionsDiv = document.createElement("div");
            optionsDiv.id = "options";
            chatBox.appendChild(optionsDiv); // Append options at the right place

            let myths = [
                "ðŸ“Œ Myth: I wonâ€™t pay any IHT on my business or company.",
                "ðŸ“Œ Myth: Surviving the 'seven-year clock' is all I have to worry about.",
                "ðŸ“Œ Myth: I have to wait seven years for a gift to be outside my estate for IHT."
            ];

            myths.forEach((myth, index) => {
                let mythOption = document.createElement("div");
                mythOption.className = "bot-message message selectable";
                mythOption.innerHTML = myth;
                mythOption.onclick = function() { selectMyth(index + 1, myth); };
                optionsDiv.appendChild(mythOption);
            });
        }

        function selectMyth(option, selectedMyth) {
            let chatBox = document.getElementById("chat-box");

            // Add user message (selected myth)
            let userMessage = document.createElement("div");
            userMessage.className = "user-message message";
            userMessage.innerHTML = selectedMyth;
            chatBox.appendChild(userMessage);

            let response = "";
            let typingTime = 2000; // Default 2 seconds

            if (option === 1) {
                response = "âœ… <b>Fact:</b> Unless Business Relief is available in full, the value (or part) of a business can be charged to IHT, creating a significant liability.<br><br>" +
                           "For example, if you have grown a Â£50m business that you would like to transfer either as part of retirement or estate planning and have not made use of Business Relief, this could create a 40% IHT liability of Â£20m.";
                typingTime = 2000;
            } 
            else if (option === 2) {
                response = "âœ… <b>Fact:</b> Gifts of chargeable assets (such as shares and property) during your lifetime are also exposed to capital gains tax (CGT), risking a significant tax charge if the value of the asset has risen since you acquired it.<br><br>" +
                           "There are also anti-avoidance provisions to prevent you from retaining benefits from gifted assets, or assets acquired via gifts of cash, so lifetime gifts can require careful thought to be an important part of IHT planning.";
                typingTime = 2500;
            } 
            else if (option === 3) {
                response = "âœ… <b>Fact:</b> Gifts of capital between you and another person are deemed potentially exempt transfers (PET) for IHT and do require you to survive seven years from the date of the gift.<br><br>" +
                           "However, not all gifts are PET, and you may have scope to make immediately exempt gifts if that is appropriate for your situation and wishes.";
                typingTime = 3000;
            }

            // Add typing indicator before showing fact
            let typingIndicator = document.createElement("div");
            typingIndicator.className = "bot-message message typing-indicator";
            typingIndicator.innerHTML = "MythBuster is typing...";
            chatBox.appendChild(typingIndicator);

            // Scroll chat to latest message
            chatBox.scrollTop = chatBox.scrollHeight;

            setTimeout(() => {
                typingIndicator.remove(); // Remove typing indicator

                // Add bot response (fact)
                let botMessage = document.createElement("div");
                botMessage.className = "bot-message message";
                botMessage.innerHTML = response;
                chatBox.appendChild(botMessage);

                // Add follow-up message before showing myths again
                setTimeout(() => {
                    let botFollowUp = document.createElement("div");
                    botFollowUp.className = "bot-message message";
                    botFollowUp.innerHTML = "ðŸ’­ Got another myth you'd like to check? Choose from the options below!";
                    chatBox.appendChild(botFollowUp);

                    // Show myths again
                    setTimeout(showMyths, 1000);
                }, 1000);
            }, typingTime);
        }

        // Show myths initially
        showMyths();
    </script>

</body>
</html>
